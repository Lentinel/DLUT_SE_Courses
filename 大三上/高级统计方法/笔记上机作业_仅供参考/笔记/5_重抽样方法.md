# 第五章 重抽样方法



引入的目的：为了估计测试误差

基本方法：将可用的样本随机分为**训练集**和**测试集**

定量的响应应使用均方误差估计，定性的响应应使用误分类率评估



## 交叉验证法

### 验证集方法

直接随机将数据集分为训练集和测试集两部分

#### 优点

- 计算简便
- 可解释性较好

#### 缺点

- 测试错误率的验证法的估计波动大，取决于具体哪些观测包含在训练集/验证集中
- 只有一个子集被用来拟合模型，验证集的错误率可能会高估在整个数据集上拟合模型的测试误差

### 留一交叉验证（LOOCV）

选一个观测作为测试集，剩下n-1个观测作为训练集，训练并测试，得到这个观测的均方误差MSE

重复这个步骤n次，得到n个MSE，然后使用如下公式计算平均的MSE
$$
CV_{(n)}=\frac{1}{n}\sum_{i=1}^{n}MSE_i
$$


### K折交叉验证

将观测机随机分为k个大小基本一致的组，每次选一个组作为测试集，剩下k-1个组作为训练集，训练并测试，得到这个测试集的均方误差MSE

重复这个步骤k次，得到n个MSE，然后同样进行平均计算

#### 优点

- 相较LOOCV，方差更低
- 相较LOOCV，计算更简便

#### 缺点

- 相较LOOCV，偏差更高
- 相较LOOCV，存在分割的随机性，LOOCV不存在这个问题

#### K折交叉验证的偏差-方差权衡

K减小，偏差减小方差增大；K增大，方差减小偏差增大



## 自助法

用途：用来衡量一个指定的估计量，比如估计线性回归模型中系数的标准误差

随机从数据集中选择n个观测（有放回的抽样），组成一个自助法数据集$Z^{·1}$，使用这个数据集对α进行自助法估计，得到$\hat{α}^{·1}$

重复B次（B是一个很大的值），得到B个对应的估计$\hat{α}^{·1},...,\hat{α}^{·B}$，然后通过公式能计算这些自助法估计的标准误差
$$
SE_B(\hat{α})=\sqrt{\frac{1}{B-1}\sum_{r=1}^{B}(\hat{α}^{·r}-\frac{1}{B}\sum_{r^{'}=1}^{B}\hat{α}^{·r^{'}})^2}
$$


### 自助法的其他用途

- 主要用于得到估计的标准误差
- 还提供了总体参数的近似置信区间



### 自助法不能估计测试误差的原因

- k折交叉验证中，每一折中的k-1训练集和验证集都不重叠
- 使用自助法估计测试误差，假如使用每个抽样的样本作为训练样本，原始样本作为验证样本，发现每个抽样样本和原始样本有显著的重叠（约三分之二），导致其严重低估真实的测试误差

